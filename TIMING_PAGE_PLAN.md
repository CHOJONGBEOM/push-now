# Timing 페이지 기획서

## 왜 시간대별 히트맵이 중요한가?

### CRM 마케터의 현실

```
"내일 오전 10시에 푸시 보내려고 하는데...
 경쟁사도 그 시간에 보내면 우리 메시지가 묻히지 않을까?"
```

**핵심 문제**: 마케터는 "언제 보내야 하는지" 매번 고민하지만, 판단 기준이 없다.

### 시간대 분석이 주는 가치

| 인사이트 | 마케터 액션 |
|----------|------------|
| "금요일 12시는 경쟁사 푸시가 가장 많다" | → 그 시간 피하기 |
| "화요일 오전 10시는 경쟁 밀도가 40% 낮다" | → 그 시간 공략 |
| "무신사는 저녁 8시에 집중한다" | → 같은 시간 vs 다른 시간 전략 선택 |
| "세일 카테고리는 점심시간에 몰린다" | → 카테고리별 타이밍 차별화 |

### 경쟁사 공백 = 골든 타임

> 경쟁사가 조용한 시간에 푸시를 보내면:
> - 사용자 알림 센터에서 우리 메시지가 더 눈에 띔
> - CTR(클릭률) 10-20% 향상 가능
> - "묻히는" 리스크 감소

---

## 화면 구성 계획

### 메인 구조 (3개 섹션)

```
┌─────────────────────────────────────────────────────────────────┐
│  Navbar                                                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  🎯 추천 발송 시간 (Golden Hours)                        │   │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐                    │   │
│  │  │ 1위     │ │ 2위     │ │ 3위     │                    │   │
│  │  │ 화 10시 │ │ 목 14시 │ │ 일 20시 │                    │   │
│  │  │ -42%    │ │ -38%    │ │ -35%    │                    │   │
│  │  └─────────┘ └─────────┘ └─────────┘                    │   │
│  │  ⚠️ 피해야 할 시간: 금 12시 (최고 밀집)                  │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  📊 시간대별 히트맵                                      │   │
│  │  필터: [앱 선택 ▼] [카테고리 ▼] [기간: 7일/30일]        │   │
│  │  ┌─────────────────────────────────────────────────┐    │   │
│  │  │     00  02  04  06  08  10  12  14  16  18  20  22│    │   │
│  │  │ 월  ░░  ░░  ░░  ░░  ▓▓  ██  ██  ▓▓  ▓▓  ██  ▓▓  ░░│    │   │
│  │  │ 화  ░░  ░░  ░░  ░░  ░░  ▓▓  ██  ▓▓  ▓▓  ▓▓  ▓▓  ░░│    │   │
│  │  │ 수  ░░  ░░  ░░  ░░  ▓▓  ▓▓  ██  ▓▓  ▓▓  ▓▓  ▓▓  ░░│    │   │
│  │  │ 목  ░░  ░░  ░░  ░░  ▓▓  ▓▓  ██  ░░  ▓▓  ▓▓  ▓▓  ░░│    │   │
│  │  │ 금  ░░  ░░  ░░  ░░  ▓▓  ██  ██  ██  ▓▓  ▓▓  ░░  ░░│    │   │
│  │  │ 토  ░░  ░░  ░░  ░░  ░░  ▓▓  ▓▓  ▓▓  ▓▓  ██  ▓▓  ░░│    │   │
│  │  │ 일  ░░  ░░  ░░  ░░  ░░  ░░  ▓▓  ▓▓  ▓▓  ██  ██  ░░│    │   │
│  │  └─────────────────────────────────────────────────┘    │   │
│  │  범례: ░ 한산  ▓ 보통  █ 밀집                           │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  📈 요일별 발송량                                        │   │
│  │  ┌─────────────────────────────────────────────────┐    │   │
│  │  │ 월 ████████                                     │    │   │
│  │  │ 화 ██████████                                   │    │   │
│  │  │ 수 █████████                                    │    │   │
│  │  │ 목 ███████████                                  │    │   │
│  │  │ 금 ████████████████ ← 피크                      │    │   │
│  │  │ 토 ███████                                      │    │   │
│  │  │ 일 █████                                        │    │   │
│  │  └─────────────────────────────────────────────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 섹션별 상세

### 1. 추천 발송 시간 (Golden Hours) - 가장 중요!

**목적**: 마케터가 페이지 열자마자 "답"을 얻을 수 있게

| 요소 | 설명 |
|------|------|
| **TOP 3 추천 시간** | 경쟁 밀도가 가장 낮은 요일+시간 조합 |
| **경쟁 밀도 %** | 평균 대비 얼마나 적은지 (예: -42%) |
| **피해야 할 시간** | 경쟁 밀도가 가장 높은 시간 경고 |

**UI 형태**: 카드 3개 + 경고 배너

**계산 로직**:
```
1. 요일×시간 매트릭스 (7×24 = 168개 슬롯) 생성
2. 각 슬롯별 발송 건수 집계
3. 전체 평균 계산
4. 평균 대비 비율로 정렬
5. 가장 낮은 3개 = 추천, 가장 높은 1개 = 피해야 할 시간
```

---

### 2. 시간대별 히트맵

**목적**: 전체 발송 패턴을 한눈에 파악

| 요소 | 설명 |
|------|------|
| **X축** | 시간 (0~23시, 2시간 단위로 묶을 수도 있음) |
| **Y축** | 요일 (월~일) |
| **셀 색상** | 발송량에 따른 밀도 (3~5단계) |
| **호버** | 해당 슬롯의 정확한 건수 표시 |
| **클릭** | 해당 시간대 푸시 목록 보기 (선택 기능) |

**색상 단계**:
```
░ 한산 (평균의 0-50%)    - bg-gray-100
▒ 보통 (평균의 50-100%)  - bg-gray-300
▓ 활발 (평균의 100-150%) - bg-gray-500
█ 밀집 (평균의 150%+)    - bg-gray-900
```

---

### 3. 요일별 발송량 바 차트

**목적**: 어떤 요일에 경쟁이 심한지 파악

| 요소 | 설명 |
|------|------|
| **막대 길이** | 해당 요일 총 발송량 |
| **피크 표시** | 가장 많은 요일 강조 |
| **색상** | 단색 (검정) 또는 밀도에 따른 그라데이션 |

---

## 필터링 옵션

### 필수 필터

| 필터 | 옵션 | 이유 |
|------|------|------|
| **기간** | 7일 / 14일 / 30일 | 최근 트렌드 vs 장기 패턴 비교 |
| **앱** | 전체 / 특정 앱 선택 | "무신사만의 패턴" 분석 가능 |
| **카테고리** | 전체 / sale / new / event 등 | "세일 푸시 타이밍" 별도 분석 |

### 선택 필터 (Phase 2)

| 필터 | 옵션 | 이유 |
|------|------|------|
| **업종** | 패션 / 이커머스 / 여행 / F&B | 업종별 패턴 비교 |
| **비교 모드** | 앱 A vs 앱 B | 경쟁사 직접 비교 |

---

## 데이터 쿼리

### 히트맵 데이터 집계

```sql
SELECT
  EXTRACT(DOW FROM posted_at) as day_of_week,  -- 0=일, 1=월, ..., 6=토
  EXTRACT(HOUR FROM posted_at) as hour,
  COUNT(*) as count
FROM push_messages
WHERE
  posted_at > NOW() - INTERVAL '30 days'
  AND (is_hidden IS NULL OR is_hidden = false)
  -- 필터 조건 추가
GROUP BY
  EXTRACT(DOW FROM posted_at),
  EXTRACT(HOUR FROM posted_at)
ORDER BY day_of_week, hour;
```

### 요일별 집계

```sql
SELECT
  EXTRACT(DOW FROM posted_at) as day_of_week,
  COUNT(*) as count
FROM push_messages
WHERE
  posted_at > NOW() - INTERVAL '30 days'
  AND (is_hidden IS NULL OR is_hidden = false)
GROUP BY EXTRACT(DOW FROM posted_at)
ORDER BY day_of_week;
```

---

## 컴포넌트 구조

```
src/pages/Timing.tsx
├── TimingHeader          # 페이지 제목 + 설명
├── GoldenHoursCard       # 🎯 추천 발송 시간 (TOP 3 + 경고)
├── TimingFilters         # 필터 바 (기간, 앱, 카테고리)
├── HeatmapChart          # 📊 시간대별 히트맵 (7×24 매트릭스)
└── DayOfWeekChart        # 📈 요일별 바 차트

src/hooks/
├── useTimingData.ts      # 히트맵 + 요일 데이터 훅
└── useGoldenHours.ts     # 추천 시간 계산 훅
```

---

## 우선순위

| 순위 | 기능 | 이유 |
|------|------|------|
| **1** | GoldenHoursCard | 가장 직관적인 가치. 페이지 핵심 |
| **2** | HeatmapChart | 시각적 임팩트, 데이터 탐색 |
| **3** | 기간 필터 | 분석 유연성 |
| **4** | 앱/카테고리 필터 | 세분화 분석 |
| **5** | DayOfWeekChart | 보조 차트 |

---

## 디자인 방향

### 톤앤매너
- Landing, Feed 페이지와 일관된 스타일
- 미니멀, 흑백 기반
- 카드 형태 컨테이너

### 색상
- 히트맵: 그레이 스케일 (gray-100 ~ gray-900)
- 강조: 검정 (#000)
- 추천 카드: 미묘한 그라데이션 또는 보더 강조

### 반응형
- 모바일: 히트맵 가로 스크롤, 카드 세로 배치
- 태블릿+: 전체 보기

---

## 예상 개발 시간

| 작업 | 예상 시간 |
|------|----------|
| 데이터 훅 (useTimingData) | 1시간 |
| GoldenHoursCard | 1시간 |
| HeatmapChart (신규) | 2시간 |
| DayOfWeekChart (기존 VolumeChart 수정) | 30분 |
| TimingFilters | 1시간 |
| 전체 조합 + 스타일링 | 1시간 |
| **합계** | **~6시간** |

---

## 참고: 마케터가 받아갈 인사이트 예시

```
📊 지난 30일 분석 결과:

🎯 추천 발송 시간
   1위: 화요일 10:00 (경쟁 밀도 평균 대비 -42%)
   2위: 목요일 14:00 (경쟁 밀도 평균 대비 -38%)
   3위: 일요일 20:00 (경쟁 밀도 평균 대비 -35%)

⚠️ 피해야 할 시간
   금요일 12:00 (경쟁 밀도 평균 대비 +180%)

💡 인사이트
   "금요일 점심은 모든 경쟁사가 몰리는 시간입니다.
    화요일 오전이나 일요일 저녁을 공략해보세요."
```

---

**문서 버전**: 1.0
**작성일**: 2026-02-09
**다음 단계**: 승인 후 구현 시작
